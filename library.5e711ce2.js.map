{"mappings":"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","sources":["src/js/modal-library.js","src/js/spiner.js"],"sourcesContent":["import { UnsplashApi } from './themoviedb';\n\nimport { renderSpinner } from './spiner';\n\nconst unsplashApi = new UnsplashApi();\nconst modalContainer = document.querySelector('#js-module');\nconst backdrop = document.querySelector('[data-modal]');\nconst gallaryList = document.querySelector('.gallery__list');\n\nexport function renderFilms(film) {\n  if (film.poster_path === null) {\n    film.poster_path =\n      'https://thumbs.dreamstime.com/b/%D1%81%D0%BA%D0%BE%D1%80%D0%BE-%D0%BD%D0%B0-%D0%B8%D0%BD%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%86%D0%B8%D0%BE%D0%BD%D0%BD%D0%BE%D0%B9-%D0%B4%D0%BE%D1%81%D0%BA%D0%B5-%D0%BF%D0%BE%D1%8F%D0%B2%D0%B8%D1%82%D1%81%D1%8F-%D0%BF%D0%BB%D0%B0%D0%BA%D0%B0%D1%82-retro-%D1%81%D0%B2%D0%B5%D1%82%D1%8F%D1%89%D0%B8%D0%B9%D1%81%D1%8F-%D0%BD%D0%B5%D0%BE%D0%BD-159994270.jpg';\n  } else {\n    film.poster_path = 'https://image.tmdb.org/t/p/w500/' + film.poster_path;\n  }\n\n  if (!film.genre_ids) {\n    film.genre_ids = 'genre unknown';\n  }\n\n  return `<div class=\"modal__backcall\">\n        <div class=\"modal__img-box\">\n          <img\n            class=\"modal__img\"\n            src=${film.poster_path} alt=${film.original_title}\n          />\n        </div>\n        <div class=\"modal__text-content\">\n          <h2 class=\"modal__title\">${film.title}</h2>\n          <div class=\"modal__dicr\">\n            <ul class=\"modal__list1\">\n              <li class=\"modal__list-item\">Vote / Votes</li>\n              <li class=\"modal__list-item\">Popularity</li>\n              <li class=\"modal__list-item\">Original Title</li>\n              <li class=\"modal__list-item\">Genre</li>\n            </ul>\n            <ul class=\"modal__list2\">\n              <li class=\"modal__item\">\n                <span class=\"modal__vote1\">${film.vote_average}</span> /\n                <span class=\"modal__vote2\">${film.vote_count}</span>\n              </li>\n              <li class=\"modal__item\">${film.popularity}</li>\n              <li class=\"modal__item\">${film.title}</li>\n              <li class=\"modal__item\">${film.genre_ids}</li>\n            </ul>\n          </div>\n          <article class=\"modal__article\">\n            <h3 class=\"modal__subtitle\">About</h3>\n            <p class=\"modal__text\">\n             ${film.overview}\n            </p>\n          </article>\n          <div class=\"modal__btn-box\">\n            <button class=\"modal__button-org\" type=\"button\">\n              add to Watched\n            </button>\n            <button class=\"modal__button-trans\" type=\"button\">\n              add to queue\n            </button>\n          </div>\n        </div>\n  </div>`;\n}\n\nconst WATCHED = 'watched';\nconst QUEUE = 'queue';\n\nfunction openModal(event) {\n  if (event.target.nodeName === 'UL') {\n    return;\n  }\n\n  document.body.insertAdjacentHTML('beforebegin', renderSpinner());\n\n  const liId = event.target.closest('[data-id]').getAttribute('data-id');\n\n  unsplashApi\n    .infoAboutFilm(liId)\n    .then(({ data }) => {\n      backdrop.classList.toggle('is-hidden');\n\n      modalContainer.innerHTML = renderFilms(data);\n\n      // btn refs\n      const btnWatched = document.querySelector('.modal__button-org');\n      const btnQueue = document.querySelector('.modal__button-trans');\n\n      // ! WATCHED\n\n      let watchedDataFromStorage = null;\n\n      try {\n        watchedDataFromStorage = localStorage.getItem(WATCHED);\n        watchedDataFromStorage =\n          watchedDataFromStorage === null\n            ? []\n            : JSON.parse(watchedDataFromStorage);\n      } catch (error) {\n        console.error('Get state error: ', error.message);\n      }\n\n      const watchedFilmFromStorage = watchedDataFromStorage.find(\n        el => el.id === data.id\n      );\n\n      if (watchedFilmFromStorage) {\n        btnWatched.addEventListener('click', onHandleRemoveWatch);\n        btnWatched.textContent = 'remove from watched';\n      } else {\n        btnWatched.addEventListener('click', onHandleWatch);\n      }\n\n      function onHandleWatch() {\n        let watchedArr = [];\n\n        if (!localStorage.getItem(WATCHED)) {\n          watchedArr.push(data);\n          localStorage.setItem(WATCHED, JSON.stringify(watchedArr));\n\n          btnWatched.removeEventListener('click', onHandleWatch);\n          btnWatched.textContent = 'remove from watched';\n          btnWatched.addEventListener('click', onHandleRemoveWatch);\n        } else if (\n          localStorage.getItem(WATCHED).includes(JSON.stringify(data))\n        ) {\n          console.log('Watched film list includes this film!');\n        } else {\n          watchedArr = JSON.parse(localStorage.getItem(WATCHED));\n          watchedArr.push(data);\n          localStorage.setItem(WATCHED, JSON.stringify(watchedArr));\n\n          btnWatched.removeEventListener('click', onHandleWatch);\n          btnWatched.textContent = 'remove from watched';\n          btnWatched.addEventListener('click', onHandleRemoveWatch);\n        }\n      }\n\n      function onHandleRemoveWatch() {\n        const watchedFilm = JSON.parse(localStorage.getItem(WATCHED));\n\n        const watchedFilmToRemove = watchedFilm.findIndex(\n          el => el.id === data.id\n        );\n\n        watchedFilm.splice(watchedFilmToRemove, 1);\n\n        localStorage.setItem(WATCHED, JSON.stringify(watchedFilm));\n        changedData(watchedFilm);\n        gallaryList.innerHTML = makeMarkup(watchedFilm);\n\n        btnWatched.removeEventListener('click', onHandleRemoveWatch);\n        btnWatched.textContent = 'add to Watched';\n        btnWatched.addEventListener('click', onHandleWatch);\n      }\n\n      // ! QUEUE\n\n      let queueDataFromStorage = null;\n\n      try {\n        queueDataFromStorage = localStorage.getItem(QUEUE);\n        queueDataFromStorage =\n          queueDataFromStorage === null ? [] : JSON.parse(queueDataFromStorage);\n      } catch (error) {\n        console.error('Get state error: ', error.message);\n      }\n\n      const queueFilmFromStorage = queueDataFromStorage.find(\n        el => el.id === data.id\n      );\n\n      if (queueFilmFromStorage) {\n        btnQueue.addEventListener('click', onHandleRemoveQueue);\n        btnQueue.textContent = 'remove from queue';\n      } else {\n        btnQueue.addEventListener('click', onHandleQueue);\n      }\n\n      function onHandleQueue() {\n        let queueArr = [];\n\n        if (!localStorage.getItem(QUEUE)) {\n          queueArr.push(data);\n          localStorage.setItem(QUEUE, JSON.stringify(queueArr));\n\n          btnQueue.removeEventListener('click', onHandleQueue);\n          btnQueue.textContent = 'remove from queue';\n          btnQueue.addEventListener('click', onHandleRemoveQueue);\n        } else if (localStorage.getItem(QUEUE).includes(JSON.stringify(data))) {\n          console.log('queue film list includes this film!');\n        } else {\n          queueArr = JSON.parse(localStorage.getItem(QUEUE));\n          queueArr.push(data);\n          localStorage.setItem(QUEUE, JSON.stringify(queueArr));\n\n          btnQueue.removeEventListener('click', onHandleQueue);\n          btnQueue.textContent = 'remove from queue';\n          btnQueue.addEventListener('click', onHandleRemoveQueue);\n        }\n      }\n\n      function onHandleRemoveQueue() {\n        const queueFilm = JSON.parse(localStorage.getItem(QUEUE));\n\n        const queueFilmToRemove = queueFilm.findIndex(el => el.id === data.id);\n\n        queueFilm.splice(queueFilmToRemove, 1);\n\n        localStorage.setItem(QUEUE, JSON.stringify(queueFilm));\n        changedData(queueFilm);\n        gallaryList.innerHTML = makeMarkup(queueFilm);\n\n        btnQueue.removeEventListener('click', onHandleRemoveQueue);\n        btnQueue.textContent = 'add to queue';\n        btnQueue.addEventListener('click', onHandleQueue);\n      }\n    })\n    .finally(() => {\n      document.querySelector('.backdrop-loader').remove();\n    });\n\n  const closeModalBtn = document.querySelector('.close');\n\n  closeModalBtn.addEventListener('click', toggleModal);\n\n  window.addEventListener('keydown', closeModalEsc);\n\n  backdrop.addEventListener('click', closeModalBackdrop);\n\n  function closeModalBackdrop(event) {\n    if (event.target === event.currentTarget) {\n      toggleModal();\n    }\n  }\n\n  function closeModalEsc(event) {\n    if (event.code === 'Escape') {\n      toggleModal();\n    }\n  }\n\n  function toggleModal() {\n    backdrop.classList.toggle('is-hidden');\n    closeModalBtn.removeEventListener('click', toggleModal);\n    window.removeEventListener('keydown', closeModalEsc);\n    backdrop.removeEventListener('click', closeModalBackdrop);\n  }\n\n  function makeMarkup(data) {\n    let markup = data\n      .map(\n        data => `<li class=\"gallery__item\" data-id=\"${data.id}\">\n      <img class=\"gallery__img\" src=\"${data.poster_path}\" alt=\"movie image\" height=\"455px\">\n      <h3 class=\"gallery__title\">${data.original_title}</h3>\n      <p class=\"gallery__text\">\n         ${data.genres}\n        <span class=\"gallery__year\">${data.release_date}</span>\n      </p>\n    </li>`\n      )\n      .join('');\n    return markup;\n  }\n\n  // GENERE\n\n  function changedData(params) {\n    const getIds = localStorage.getItem('genre_ids');\n    const parseIds = JSON.parse(getIds);\n    console.log(params);\n    return params.forEach(param => {\n      param.genres.forEach((genre, ind, arr) => {\n        for (let i = 0; i < parseIds.length; i += 1) {\n          if (genre.id === parseIds[i].id) {\n            arr[ind] = parseIds[i].name;\n            break;\n          }\n        }\n      });\n\n      if (param.poster_path === null) {\n        param.poster_path =\n          'https://thumbs.dreamstime.com/b/%D1%81%D0%BA%D0%BE%D1%80%D0%BE-%D0%BD%D0%B0-%D0%B8%D0%BD%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%86%D0%B8%D0%BE%D0%BD%D0%BD%D0%BE%D0%B9-%D0%B4%D0%BE%D1%81%D0%BA%D0%B5-%D0%BF%D0%BE%D1%8F%D0%B2%D0%B8%D1%82%D1%81%D1%8F-%D0%BF%D0%BB%D0%B0%D0%BA%D0%B0%D1%82-retro-%D1%81%D0%B2%D0%B5%D1%82%D1%8F%D1%89%D0%B8%D0%B9%D1%81%D1%8F-%D0%BD%D0%B5%D0%BE%D0%BD-159994270.jpg';\n      } else {\n        param.poster_path =\n          'https://image.tmdb.org/t/p/w500/' + param.poster_path;\n      }\n\n      if (param.release_date) {\n        param.release_date = param.release_date.slice(0, 4);\n      } else {\n        param.release_date = 'release year unknown';\n      }\n\n      if (!param.genres.length) {\n        param.genres = 'genre unknown';\n      }\n    });\n  }\n}\ngallaryList.addEventListener('click', openModal);\n\n// !!!\n","export const renderSpinner = () => {\n  return `<div class=\"backdrop-loader\"><div class=\"loader\">\n        <div><div></div></div>\n        <div><div></div></div>\n        <div><div></div></div>\n        <div><div></div></div>\n        <div><div></div></div>\n        <div><div></div></div>\n        <div><div></div></div>\n        <div><div></div></div>\n        <div><div></div></div>\n        <div><div></div></div>\n        <div><div></div></div>\n        <div><div></div></div>\n      </div></div>`;\n};\n"],"names":["$662h5","parcelRequire","$2631b5b1e00936b8$var$unsplashApi","UnsplashApi","$2631b5b1e00936b8$var$modalContainer","document","querySelector","$2631b5b1e00936b8$var$backdrop","$2631b5b1e00936b8$var$gallaryList","addEventListener","event1","target","nodeName","body","insertAdjacentHTML","liId","closest","getAttribute","infoAboutFilm","then","data","film","classList","toggle","innerHTML","poster_path","genre_ids","original_title","title","vote_average","vote_count","popularity","overview","btnWatched","btnQueue","watchedDataFromStorage","localStorage","getItem","JSON","parse","error","console","message","onHandleWatch","watchedArr","includes","stringify","log","push","setItem","removeEventListener","textContent","onHandleRemoveWatch","watchedFilm","watchedFilmToRemove","findIndex","el","id","splice","changedData","makeMarkup","find","queueDataFromStorage","error1","onHandleQueue","queueArr","onHandleRemoveQueue","queueFilm","queueFilmToRemove","finally","remove","closeModalBtn","closeModalBackdrop","event","currentTarget","toggleModal","closeModalEsc","code","window","data1","map","genres","release_date","join","params","getIds","parseIds","forEach","param","genre","ind","arr","i","length","name","slice"],"version":3,"file":"library.5e711ce2.js.map"}