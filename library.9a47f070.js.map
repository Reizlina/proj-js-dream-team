{"mappings":"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","sources":["src/js/modal-library.js","src/js/spiner.js"],"sourcesContent":["import { UnsplashApi } from './themoviedb';\n\nimport { renderSpinner } from './spiner';\n\nconst unsplashApi = new UnsplashApi();\nconst modalContainer = document.querySelector('#js-module');\nconst backdrop = document.querySelector('[data-modal]');\nconst gallaryList = document.querySelector('.gallery__list');\n\nexport function renderFilms(film) {\n  if (film.poster_path === null) {\n    film.poster_path =\n      'https://thumbs.dreamstime.com/b/%D1%81%D0%BA%D0%BE%D1%80%D0%BE-%D0%BD%D0%B0-%D0%B8%D0%BD%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%86%D0%B8%D0%BE%D0%BD%D0%BD%D0%BE%D0%B9-%D0%B4%D0%BE%D1%81%D0%BA%D0%B5-%D0%BF%D0%BE%D1%8F%D0%B2%D0%B8%D1%82%D1%81%D1%8F-%D0%BF%D0%BB%D0%B0%D0%BA%D0%B0%D1%82-retro-%D1%81%D0%B2%D0%B5%D1%82%D1%8F%D1%89%D0%B8%D0%B9%D1%81%D1%8F-%D0%BD%D0%B5%D0%BE%D0%BD-159994270.jpg';\n  } else {\n    film.poster_path = 'https://image.tmdb.org/t/p/w500/' + film.poster_path;\n  }\n\n  if (!film.genre_ids) {\n    film.genre_ids = 'genre unknown';\n  }\n\n  return `<div class=\"modal__backcall\">\n        <div class=\"modal__img-box\">\n          <img\n            class=\"modal__img\"\n            src=${film.poster_path} alt=${film.original_title}\n          />\n        </div>\n        <div class=\"modal__text-content\">\n          <h2 class=\"modal__title\">${film.title}</h2>\n          <div class=\"modal__dicr\">\n            <ul class=\"modal__list1\">\n              <li class=\"modal__list-item\">Vote / Votes</li>\n              <li class=\"modal__list-item\">Popularity</li>\n              <li class=\"modal__list-item\">Original Title</li>\n              <li class=\"modal__list-item\">Genre</li>\n            </ul>\n            <ul class=\"modal__list2\">\n              <li class=\"modal__item\">\n                <span class=\"modal__vote1\">${film.vote_average}</span> /\n                <span class=\"modal__vote2\">${film.vote_count}</span>\n              </li>\n              <li class=\"modal__item\">${film.popularity}</li>\n              <li class=\"modal__item\">${film.title}</li>\n              <li class=\"modal__item\">${film.genre_ids}</li>\n            </ul>\n          </div>\n          <article class=\"modal__article\">\n            <h3 class=\"modal__subtitle\">About</h3>\n            <p class=\"modal__text\">\n             ${film.overview}\n            </p>\n          </article>\n          <div class=\"modal__btn-box\">\n            <button class=\"modal__button-org\" type=\"button\">\n              add to Watched\n            </button>\n            <button class=\"modal__button-trans\" type=\"button\">\n              add to queue\n            </button>\n          </div>\n        </div>\n  </div>`;\n}\n\nconst WATCHED = 'watched';\nconst QUEUE = 'queue';\n\nfunction openModal(event) {\n  if (event.target.nodeName === 'UL') {\n    return;\n  }\n\n  document.body.insertAdjacentHTML('beforebegin', renderSpinner());\n\n  const liId = event.target.closest('[data-id]').getAttribute('data-id');\n\n  unsplashApi\n    .infoAboutFilm(liId)\n    .then(({ data }) => {\n      backdrop.classList.toggle('is-hidden');\n\n      modalContainer.innerHTML = renderFilms(data);\n\n      // btn refs\n      const btnWatched = document.querySelector('.modal__button-org');\n      const btnQueue = document.querySelector('.modal__button-trans');\n\n      // ! WATCHED\n\n      let watchedDataFromStorage = null;\n\n      try {\n        watchedDataFromStorage = localStorage.getItem(WATCHED);\n        watchedDataFromStorage =\n          watchedDataFromStorage === null\n            ? []\n            : JSON.parse(watchedDataFromStorage);\n      } catch (error) {\n        console.error('Get state error: ', error.message);\n      }\n\n      const watchedFilmFromStorage = watchedDataFromStorage.find(\n        el => el.id === data.id\n      );\n\n      if (watchedFilmFromStorage) {\n        btnWatched.addEventListener('click', onHandleRemoveWatch);\n        btnWatched.textContent = 'remove from watched';\n      } else {\n        btnWatched.addEventListener('click', onHandleWatch);\n      }\n\n      function onHandleWatch() {\n        let watchedArr = [];\n\n        if (!localStorage.getItem(WATCHED)) {\n          watchedArr.push(data);\n          localStorage.setItem(WATCHED, JSON.stringify(watchedArr));\n\n          btnWatched.removeEventListener('click', onHandleWatch);\n          btnWatched.textContent = 'remove from watched';\n          btnWatched.addEventListener('click', onHandleRemoveWatch);\n        } else if (\n          localStorage.getItem(WATCHED).includes(JSON.stringify(data))\n        ) {\n          console.log('Watched film list includes this film!');\n        } else {\n          watchedArr = JSON.parse(localStorage.getItem(WATCHED));\n          watchedArr.push(data);\n          localStorage.setItem(WATCHED, JSON.stringify(watchedArr));\n\n          btnWatched.removeEventListener('click', onHandleWatch);\n          btnWatched.textContent = 'remove from watched';\n          btnWatched.addEventListener('click', onHandleRemoveWatch);\n        }\n      }\n\n      function onHandleRemoveWatch() {\n        const watchedFilm = JSON.parse(localStorage.getItem(WATCHED));\n\n        const watchedFilmToRemove = watchedFilm.findIndex(\n          el => el.id === data.id\n        );\n\n        watchedFilm.splice(watchedFilmToRemove, 1);\n\n        localStorage.setItem(WATCHED, JSON.stringify(watchedFilm));\n        changedData(watchedFilm);\n        gallaryList.innerHTML = makeMarkup(watchedFilm);\n\n        btnWatched.removeEventListener('click', onHandleRemoveWatch);\n        btnWatched.textContent = 'add to Watched';\n        btnWatched.addEventListener('click', onHandleWatch);\n      }\n\n      // ! QUEUE\n\n      let queueDataFromStorage = null;\n\n      try {\n        queueDataFromStorage = localStorage.getItem(QUEUE);\n        queueDataFromStorage =\n          queueDataFromStorage === null ? [] : JSON.parse(queueDataFromStorage);\n      } catch (error) {\n        console.error('Get state error: ', error.message);\n      }\n\n      const queueFilmFromStorage = queueDataFromStorage.find(\n        el => el.id === data.id\n      );\n\n      if (queueFilmFromStorage) {\n        btnQueue.addEventListener('click', onHandleRemoveQueue);\n        btnQueue.textContent = 'remove from queue';\n      } else {\n        btnQueue.addEventListener('click', onHandleQueue);\n      }\n\n      function onHandleQueue() {\n        let queueArr = [];\n\n        if (!localStorage.getItem(QUEUE)) {\n          queueArr.push(data);\n          localStorage.setItem(QUEUE, JSON.stringify(queueArr));\n\n          btnQueue.removeEventListener('click', onHandleQueue);\n          btnQueue.textContent = 'remove from queue';\n          btnQueue.addEventListener('click', onHandleRemoveQueue);\n        } else if (localStorage.getItem(QUEUE).includes(JSON.stringify(data))) {\n          console.log('queue film list includes this film!');\n        } else {\n          queueArr = JSON.parse(localStorage.getItem(QUEUE));\n          queueArr.push(data);\n          localStorage.setItem(QUEUE, JSON.stringify(queueArr));\n\n          btnQueue.removeEventListener('click', onHandleQueue);\n          btnQueue.textContent = 'remove from queue';\n          btnQueue.addEventListener('click', onHandleRemoveQueue);\n        }\n      }\n\n      function onHandleRemoveQueue() {\n        const queueFilm = JSON.parse(localStorage.getItem(QUEUE));\n\n        const queueFilmToRemove = queueFilm.findIndex(el => el.id === data.id);\n\n        queueFilm.splice(queueFilmToRemove, 1);\n\n        localStorage.setItem(QUEUE, JSON.stringify(queueFilm));\n        changedData(queueFilm);\n        gallaryList.innerHTML = makeMarkup(queueFilm);\n\n        btnQueue.removeEventListener('click', onHandleRemoveQueue);\n        btnQueue.textContent = 'add to queue';\n        btnQueue.addEventListener('click', onHandleQueue);\n      }\n    })\n    .finally(() => {\n      document.querySelector('.backdrop-loader').remove();\n    });\n\n  const closeModalBtn = document.querySelector('.close');\n\n  closeModalBtn.addEventListener('click', toggleModal);\n\n  window.addEventListener('keydown', closeModalEsc);\n\n  backdrop.addEventListener('click', closeModalBackdrop);\n\n  function closeModalBackdrop(event) {\n    if (event.target === event.currentTarget) {\n      toggleModal();\n    }\n  }\n\n  function closeModalEsc(event) {\n    if (event.code === 'Escape') {\n      toggleModal();\n    }\n  }\n\n  function toggleModal() {\n    backdrop.classList.toggle('is-hidden');\n    closeModalBtn.removeEventListener('click', toggleModal);\n    window.removeEventListener('keydown', closeModalEsc);\n    backdrop.removeEventListener('click', closeModalBackdrop);\n  }\n\n  function makeMarkup(data) {\n    let markup = data\n      .map(\n        data => `<li class=\"gallery__item\" data-id=\"${data.id}\">\n      <img class=\"gallery__img\" src=\"${data.poster_path}\" alt=\"movie image\" height=\"455px\">\n      <h3 class=\"gallery__title\">${data.original_title}</h3>\n      <p class=\"gallery__text\">\n         ${data.genres}\n        <span class=\"gallery__year\">${data.release_date}</span>\n      </p>\n    </li>`\n      )\n      .join('');\n    return markup;\n  }\n\n  // GENERE\n\n  function changedData(params) {\n    const getIds = localStorage.getItem('genre_ids');\n    const parseIds = JSON.parse(getIds);\n    console.log(params);\n    return params.forEach(param => {\n      param.genres.forEach((genre, ind, arr) => {\n        for (let i = 0; i < parseIds.length; i += 1) {\n          if (genre.id === parseIds[i].id) {\n            arr[ind] = parseIds[i].name;\n            break;\n          }\n        }\n      });\n\n      if (param.poster_path === null) {\n        param.poster_path =\n          'https://thumbs.dreamstime.com/b/%D1%81%D0%BA%D0%BE%D1%80%D0%BE-%D0%BD%D0%B0-%D0%B8%D0%BD%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%86%D0%B8%D0%BE%D0%BD%D0%BD%D0%BE%D0%B9-%D0%B4%D0%BE%D1%81%D0%BA%D0%B5-%D0%BF%D0%BE%D1%8F%D0%B2%D0%B8%D1%82%D1%81%D1%8F-%D0%BF%D0%BB%D0%B0%D0%BA%D0%B0%D1%82-retro-%D1%81%D0%B2%D0%B5%D1%82%D1%8F%D1%89%D0%B8%D0%B9%D1%81%D1%8F-%D0%BD%D0%B5%D0%BE%D0%BD-159994270.jpg';\n      } else {\n        param.poster_path =\n          'https://image.tmdb.org/t/p/w500/' + param.poster_path;\n      }\n\n      if (param.release_date) {\n        param.release_date = param.release_date.slice(0, 4);\n      } else {\n        param.release_date = 'release year unknown';\n      }\n\n      if (!param.genres.length) {\n        param.genres = 'genre unknown';\n      }\n    });\n  }\n}\ngallaryList.addEventListener('click', openModal);\n\n// !!!\n","export const renderSpinner = () => {\n  return `<div class=\"backdrop-loader\"><div class=\"loader\">\n        <div><div></div></div>\n        <div><div></div></div>\n        <div><div></div></div>\n        <div><div></div></div>\n        <div><div></div></div>\n        <div><div></div></div>\n        <div><div></div></div>\n        <div><div></div></div>\n        <div><div></div></div>\n        <div><div></div></div>\n        <div><div></div></div>\n        <div><div></div></div>\n      </div></div>`;\n};\n"],"names":["$54vAX","parcelRequire","$5274909fd9dfb2b1$var$unsplashApi","UnsplashApi","$5274909fd9dfb2b1$var$modalContainer","document","querySelector","$5274909fd9dfb2b1$var$backdrop","$5274909fd9dfb2b1$var$gallaryList","$5274909fd9dfb2b1$var$WATCHED","$5274909fd9dfb2b1$var$QUEUE","addEventListener","event1","target","nodeName","body","insertAdjacentHTML","liId","closest","getAttribute","infoAboutFilm","then","param","film","data","classList","toggle","innerHTML","poster_path","genre_ids","concat","original_title","title","vote_average","vote_count","popularity","overview","btnWatched","btnQueue","watchedDataFromStorage","localStorage","getItem","JSON","parse","error","console","message","onHandleWatch","watchedArr","includes","stringify","log","push","setItem","removeEventListener","textContent","onHandleRemoveWatch","watchedFilm","watchedFilmToRemove","findIndex","el","id","splice","changedData","makeMarkup","find","queueDataFromStorage","error1","onHandleQueue","queueArr","onHandleRemoveQueue","queueFilm","queueFilmToRemove","finally","remove","closeModalBtn","toggleModal","window","closeModalEsc","closeModalBackdrop","event","currentTarget","code","data1","map","genres","release_date","join","params","getIds","parseIds","forEach","genre","ind","arr","i","length","name","slice"],"version":3,"file":"library.9a47f070.js.map"}